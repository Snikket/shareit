<HTML>
  <HEADER><TITLE>ShareIt!</TITLE></HEADER>
  
  <head>
	<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="http://code.jquery.com/jquery-migrate-1.1.1.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  </head>

{% extends 'shareit/base-bootstrap.html' %}
<BODY>
{% block content %}

<p align="right"><a href="#" class="btn btn-info btn-small"><i class="icon-white icon-plus"></i> Add to My Categories</a></p>
<p align="right"><a href="#" class="btn btn-info btn-small"><i class="icon-white icon-minus"></i> Remove from My Categories</a></p>

<H2> {{cat_name}}</H2>
{% if posts_list %}
		{% for post in posts_list %}
			<div class="well">
			{% if post.userProfile.picture %}
				<a href="/shareit/profiles/{{post.userProfile}}"><img src="{{STATIC_URL}}{{ post.userProfile.picture }}" width="30" height="40" /> <a/>
			{% else %}
				<img src="{{STATIC_URL}}imgs/nophoto.jpg" width="30" height="40"/>
			{%endif%}

			<a href="/shareit/profiles/{{post.userProfile}}">{{post.userProfile}} </a>
			<div id="userPost" name="userPost" class="well"> <p class="minimize">{{post}}</p></div>
			{% if links %}
			<div class="well">Links in this post:<br/>
				{% for link in links %}
					{% if link.linkPost == post %}
						<li> <a href={{link.url}}>{{link}}</a></li>
					{%endif%}
				{% endfor %}
			</div>
			{% endif %}


			<!-- Thumbs-up and Thumbs-down button -->
			<div align="right">
				<a id="thumbsdown{{post.id}}" data-postid="{{post.id}}" class="btn btn-primary"><i class="icon-white icon-thumbs-down"></i></a>
				<b id="tdown_count">{{ post.thumbsdown }}</b> 
				<a id="thumbsup{{post.id}}" data-postid="{{post.id}}" class="btn btn-primary"><i class="icon-white icon-thumbs-up"></i></a>
				<b id="tup_count">{{ post.thumbsup }}</b> 

			</div>

			<form id="myForm2" method="post" action="/shareit/add_comment/{{post.id}}">
			{% csrf_token %}
				<p class="commentminimize"> 
				{% for comment in comments_list %}
					{% if comment.cPost = post %}
<p class="comment2">
						{{comment.cUser}} said: {{comment}}<br /><br />
</p>
					{%endif%}
				{% endfor %}
				</p>
				<textarea id="t2" name="commentBox" type="text" value="Comments" class="input-block-level"></textarea><br/>
				<input id="b2" value="Comment" name="submit" type="submit"/>
			<br/><br/>
		</form>

		<script>
		$(document).ready(function(){
			$("#thumbsup{{post.id}}").click(function(){
				var postid;
				postid = $(this).attr("data-postid");
				$.get('/shareit/post_tu', {postid: postid}, function(data){
					$('#tup_count').html(data);
					//$('#thumbsup{{post.id}}').hide();
					//$('#thumbsdown{{post.id}}').hide();
					$('#thumbsup{{post.id}}').attr("disabled", true);
					$('#thumbsdown{{post.id}}').attr("disabled",true);
				});
			});
		});

		$(document).ready(function() {
			$('#thumbsdown{{post.id}}').click(function(){
				var postid;
				postid = $(this).attr("data-postid");
				$.get('/shareit/post_tdown', {postid: postid}, function(data){
					$('#tdown_count').html(data);					
					$('#thumbsdown{{post.id}}').attr("disabled", true);
					$('#thumbsup{{post.id}}').attr("disabled", true);
				});
			});
		});
		</script>
		</div>
		{%endfor%}

	{% else %}
		<p> No Posts in this category</p>
	{%endif%}

<script>
jQuery(function(){

    var minimized_elements = $('p.minimize');
    var minimized_comments = $('p.commentminimize');

    minimized_elements.each(function(){    
        var t = $(this).text();        
        if(t.length < 100) return;
        
        $(this).html(
            t.slice(0,100)+'<span>... </span><a href="#" class="more">Read More</a>'+
            '<span style="display:none;">'+ t.slice(100,t.length)+' <a href="#" class="less">Less</a></span>'
        );
        
    }); 
    
    $('a.more', minimized_elements).click(function(event){
        event.preventDefault();
        $(this).hide().prev().hide();
        $(this).next().show();        
    });
    
    $('a.less', minimized_elements).click(function(event){
        event.preventDefault();
        $(this).parent().hide().prev().show().prev().show();    
    });

	 minimized_comments.each(function(){    
        var t = $(this).text();       
        if(t.length < 0) return;
        
        $(this).html(
            t.slice(0,0)+'<span> </span><a href="#" class="more">See Comments</a>'+
            '<span style="display:none;">'+ t.slice(1,t.length)+ '<a href="#" class="less">Hide Comments</a></span>'
        );
        
    }); 

    $('a.more', minimized_comments).click(function(event){
        event.preventDefault();
        $(this).hide().prev().hide();
        $(this).next().show();
	$('p.comment2').show();

	        
    });
    
    $('a.less', minimized_comments).click(function(event){
        event.preventDefault();
        $(this).parent().hide().prev().show().prev().show();   
	$('p.comment2').hide(); 
    });


});
</script>
{% endblock %}
{% block rightsidebar %}
			
			<!-- Drop down for categoryFiler-->
			<label>Show posts by:</label>
			<div class="btn-group" id="drop">
				<select id="filterUser" name="userFilter">			
				<option value="E">Everyone</option>
				<option value="F">Following</option>
				</select>
	  		</div>	

{% endblock %}
</BODY>
</HTML>
